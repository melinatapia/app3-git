/* @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&dn=gpl-3.0.txt GPL-v3-or-Later */
var Main=function(a){var b={reportPopup:null,deletePopup:null,editPopup:null,lightboxes:{},updatesTabTimer:-1,curLatestUpdates:null,timerLatestUpdatesRelated:null,shareBoxWidth:-1,shareBoxTimeout:null,LoadAjaxTeaserListerTab:function(g){if(g.indexOf("#")==0){g=g.substring(1)}if(b.curLatestUpdates==null){b.curLatestUpdates=a(".tabs-holder:first")}var i=a("input[id=hidAjaxInput]",b.curLatestUpdates).val()+"&"+g;a("div.tabset ul a",b.curLatestUpdates).removeClass("active");var k=a.query.load("?"+g).get("tab");if(k==null||k==""||k.toString()=="true"){var f=a.query.load("?"+i).get("dta");a("div.tabset ul a:eq("+f+")",b.curLatestUpdates).addClass("active")}else{a("div.tabset ul a:eq("+k+")",b.curLatestUpdates).addClass("active")}if(a(".rssmultimedia").length){var j=a.query.load("?"+i).get("ta").split("|");if(j[k]=="MULTIMEDIAVIDEO"||j[k]=="MULTIMEDIAIMAGE_MULTIMEDIAIMAGEGALLERY"){var l=a(".rssmultimedia a").attr("href").split("?");if(l.length==2){var h;if(j[k]=="MULTIMEDIAVIDEO"){h=a.query.load("?"+l[1]).set("type","videos")}else{h=a.query.load("?"+l[1]).set("type","photos")}a(".rssmultimedia a").attr("href",l[0]+h.toString());a(".rssmultimedia").show()}}}var d=(a("input[name=hidAjaxBasePath]",b.curLatestUpdates.parent()).length)?a("input[name=hidAjaxBasePath]",b.curLatestUpdates.parent()).val():resources.app_path;var e=(a("input[name=hidAjaxUICulture]",b.curLatestUpdates.parent()).length)?a("input[name=hidAjaxUICulture]",b.curLatestUpdates.parent()).val():resources.uiculture;var c=new Date().getTime();a.ajax({type:"POST",url:d+"Templates/Planet3/Handlers/GetControl.ashx?cb="+c,data:"loadControl=~/Templates/Planet3/UserControls/Teasers/TeaserLister.ascx&queryString="+encodeURIComponent(i)+"&uiculture="+e,success:function(m){if(b.updatesTabTimer!=-1){clearTimeout(b.updatesTabTimer);b.updatesTabTimer=-1}if(m=="error"){a(".reload",b.curLatestUpdates).html('<div style="color:red">An error occurred please try again later.</div>')}else{a(".reload",b.curLatestUpdates).html(a("#reload",m).html());if(a("#hidConnectToRelatedItems").val()=="True"){if(b.timerLatestUpdatesRelated!=null){clearTimeout(b.timerLatestUpdatesRelated)}b.timerLatestUpdatesRelated=setTimeout("Main.UpdateLatestUpdatesRelated()",500)}b.SetAjaxLinksPaging();b.SetAjaxTopicFilter();a("div.tabset ul a",b.curLatestUpdates).unbind("click");a("div.tabset ul a",b.curLatestUpdates).click(function(){b.curLatestUpdates=a(this).parents(".tabs-holder");lup=a(".tabs-holder").index(a(this).parents(".tabs-holder"));q=a.query.load(a(this).attr("href"));if(lup>0){q=q.set("lup",lup)}newhref=q.toString().replace("?","#");a(this).attr("href",newhref);var n=this.href;n=n.replace(/^.*#/,"");location.hash=n;return false})}}});if(b.updatesTabTimer==-1){b.updatesTabTimer=setTimeout("Main.ShowAjaxLoader();",300)}if(a(".reload",b.curLatestUpdates).data("scrollIntoView")){a(".reload",b.curLatestUpdates).parent()[0].scrollIntoView();a(".reload",b.curLatestUpdates).data("scrollIntoView",false)}},SetAjaxLinks:function(){if(a("#hidAjaxInput").length&&a("#hidAjaxInput").val()!=""){var c=0;a("div.tabset ul a,.top-holder a.show").each(function(d){c=a(".tabs-holder").index(a(this).parents(".tabs-holder"));q=a.query.load(a(this).attr("href"));if(c>0){q=q.set("lup",c)}newhref=q.toString().replace("?","#");a(this).attr("href",newhref);a(this).click(function(){b.curLatestUpdates=a(this).parents(".tabs-holder");var e=this.href;e=e.replace(/^.*#/,"");location.hash=e;return false})});b.SetAjaxLinksPaging();b.SetAjaxTopicFilter()}},SetAjaxTopicFilter:function(){a("#tab1 .sort select, #tab1 .top-holder select").bind("change",function(){var f="st="+a(this).val();b.curLatestUpdates=a(this).parents(".tabs-holder");var d="";if(location.href.indexOf("#")!=-1){var c=a.query.load("?"+location.href.split("#")[1]);lup=a(".tabs-holder").index(a(this).parents(".tabs-holder"));if(lup>0){d+="&lup="+lup}var g=c.get("tab").toString();var e=c.get("gvs").toString();if(g!=""&&g!="true"){d+="&tab="+c.get("tab")}if(e!=""){d+="&gvs="+c.get("gvs")}}location.hash=f+d})},SetAjaxLinksPaging:function(){a("div.paginator a",b.curLatestUpdates).each(function(c){if(!a(this).hasClass("deactive")){lup=a(".tabs-holder").index(a(this).parents(".tabs-holder"));q=a.query.load(a(this).attr("href"));if(lup>0){q=q.set("lup",lup)}newhref=q.toString().replace("?","#");if(q.get("page")!=""){a(this).attr("href",newhref)}}}).click(function(){b.curLatestUpdates=a(this).parents(".tabs-holder");a(".reload",b.curLatestUpdates).data("scrollIntoView",true)})},ShowOptions:function(d,h){if(a("#optionsDiv"+h).length==0){var c=a('<div id="optionsDiv'+h+'" class="outtaHere optionsDivInvisible"></div>');var e=a("<ul></ul>");a("select option",d.parent()).each(function(m){var l=a('<li><a href="'+a(this).val()+'">'+a(this).text()+"</a></li>");e.append(l)});c.append(e);var k=215;var j=d.width()-1;var f=a("select",d.parent()).attr("class");if(f!=null&&f.indexOf("width;")!=-1){k=parseInt(f.split(";")[1])}if(j>k){k=j}else{d.width(k+"px")}var i=d.offset();c.css({top:(i.top+d.outerHeight(true))+"px",width:k+"px","overflow-y":"auto","max-height":"450px",direction:"ltr",right:"auto",left:i.left+"px"});a("body").append(c)}else{var k=215;var j=d.width()-1;var f=a("select",d.parent()).attr("class");if(f!=null&&f.indexOf("width;")!=-1){k=parseInt(f.split(";")[1])}if(j<k){d.width(k+"px")}}var g=d.offset();a("#optionsDiv"+h).css({right:"auto",left:g.left+"px"});a("#optionsDiv"+h).removeClass("optionsDivInvisible");a("#optionsDiv"+h).addClass("optionsDivVisible");a("#optionsDiv"+h).show()},HideOptions:function(c){a("#optionsDiv"+c).addClass("optionsDivInvisible");a("#optionsDiv"+c).removeClass("optionsDivVisible");a("#optionsDiv"+c).hide()},HideAllOptions:function(){a("div.selectArea").removeClass("active-select").css("width","auto");a("div.optionsDivVisible").each(function(c){a(this).addClass("optionsDivInvisible");a(this).removeClass("optionsDivVisible");a(this).hide()})},MakeLinkOpenUpInNewWindow:function(d,c){d.addClass(c);if(d.attr("target")==null||d.attr("target")==""){d.attr("target","_blank")}},IsExternalLink:function(c){var d=(c.indexOf("http://")!=-1&&c.indexOf(location.hostname)==-1);if(typeof(internalDomainsArray)!="undefined"&&internalDomainsArray){a.each(internalDomainsArray,function(e,f){d=(d&&c.indexOf(f)==-1)})}return d}};return{ApplyLinkIcons:function(d){var c=d.attr("href");if(!c||c==""){return}if(c.indexOf(".pdf")!=-1){b.MakeLinkOpenUpInNewWindow(d,"pdf")}else{if(b.IsExternalLink(c)){b.MakeLinkOpenUpInNewWindow(d,"zoom")}}},UpdateLatestUpdatesRelated:function(){var c=(a("input[name=hidAjaxBasePath]",b.curLatestUpdates.parent()).length)?a("input[name=hidAjaxBasePath]",b.curLatestUpdates.parent()).val():resources.base_url;var d=(a("input[name=hidAjaxUICulture]",b.curLatestUpdates.parent()).length)?a("input[name=hidAjaxUICulture]",b.curLatestUpdates.parent()).val():resources.uiculture;var f=a.query.load(a(".tabset a.active",b.curLatestUpdates).attr("href").replace("#","?")).get("tab");var e=a.query.load("?"+a("#hidAjaxInput",b.curLatestUpdates).val()).get("ta").toString().split("|")[f];a(".csn").each(function(h){var g=a(this);var j=a(".hidAjaxInput",g).val()+"&ta="+e;a.ajax({type:"POST",url:c+"Templates/Planet3/Handlers/GetControl.ashx",data:"loadControl=~/Templates/Planet3/UserControls/DynamicContent/CrossSectionNavigation.ascx&queryString="+encodeURIComponent(j)+"&uiculture="+d,success:function(i){if(i!="error"){g.html(a(i).html());g.effect("highlight",{color:"#DFFEBE"},1000)}}})})},pinFooterToBottomPage:function(){if(!(a("#reload").length||a("#visual").length)&&a("div.pin-footer-to-bottom-page").length){a("div.page:first").height("auto");var f=a(window).height();var c=a("body").height();if(f>c){var d=a("div.pin-footer-to-bottom-page").height();var e=f-d;a("div.page:first").height(e)}}},shareBarOnResize:function(){if(a("#share_rail").length){if(b.shareBoxTimeout!=null){clearTimeout(b.shareBoxTimeout);b.shareBoxTimeout=null}b.shareBoxTimeout=setTimeout(function(){var d=(resources.textdirection=="rtl");var e=15;var c=false;if(b.shareBoxWidth==-1||b.shareBoxWidth<a("#share_rail #share_pos.share_sidebar .paper").width()+e){b.shareBoxWidth=a("#share_rail .paper").width()+e;c=true}var j=a(window).width();var g=960;if(j<=(g+((b.shareBoxWidth-e)*2))){if(a.browser.msie){a("#share_rail").css({width:"auto",position:"relative"})}a("#share_pos").removeClass("share_sidebar share_topbar").addClass("share_topbar");if(d){if(!c){a("#share_rail").animate({marginRight:0})}else{a("#share_rail").css({marginRight:0})}}else{if(!c){a("#share_rail").animate({marginLeft:0})}else{a("#share_rail").css({marginLeft:0})}}}else{if(a.browser.msie){a("#share_rail").css({width:"80px",position:"absolute"})}a("#share_pos").removeClass("share_sidebar share_topbar").addClass("share_sidebar");if(b.shareBoxWidth<a("#share_rail .paper").width()+e){b.shareBoxWidth=a("#share_rail .paper").width()+e}if(d){if(!c){a("#share_rail").animate({marginRight:-b.shareBoxWidth})}else{a("#share_rail").css({marginRight:-b.shareBoxWidth})}}else{if(!c){a("#share_rail").animate({marginLeft:-b.shareBoxWidth})}else{a("#share_rail").css({marginLeft:-b.shareBoxWidth})}}var f=a("#share_rail").get(0).offsetTop;var h=a("#share_rail .paper").height();var i=a(window).height();if((f+h)>i){a("#share_pos").css("bottom","5px")}}if(c){a("#share_rail").css({visibility:"visible"})}},150)}},openLightbox:function(d,e,c){if(!b.lightboxes[d]){if(typeof(e)=="undefined"||!e){e={container:document.getElementById(d)}}b.lightboxes[d]=new Lightbox(e,c)}b.lightboxes[d].Show()},ShowReportCommentPopup:function(c){a("#currentCommentId").val(c);if(b.reportPopup==null){b.reportPopup=new Lightbox({container:document.getElementById("pReport"),width:"605px"})}b.reportPopup.Show()},ShowRemoveCommentPopup:function(c){a("#currentCommentId").val(c);a(".comment-box img").attr("src",a("#comment_"+c+" img").attr("src"));a(".comment-box strong").html(a("#comment_"+c+" .block .say p strong").html());a(".comment-box blockquote q").html(a("#comment_"+c+" .block p.comment-content").html());if(b.deletePopup==null){b.deletePopup=new Lightbox({container:document.getElementById("pDelete"),width:"605px"})}b.deletePopup.Show()},ShowCommentCaptchaPopup:function(c){a("#hfCaptchaPopUpCallbackClientTarget").val(c);if(b.capthcaPopup==null){b.capthcaPopup=new Lightbox({container:document.getElementById("pCaptchaPopup"),width:"605px"})}b.capthcaPopup.Show()},ToggleComment:function(d,c){a(d).toggleClass("readless");a("#comment_"+c+" .block p.short-comment").toggle();a("#comment_"+c+" .block p.full-comment").toggle();return false},ShowAjaxLoader:function(){a(".reload div.tab",b.curLatestUpdates).hide();a(".reload div.ajaxloader",b.curLatestUpdates).show()},DoSimpleSearch:function(f,d){if(f==resources.header_search_searchboxvalue||a.trim(f)==""){return false}var e="";if(d!=null&&d){var g=a.query.GET("tab");if(g!=""&&g!=null){e+="&tab="+g}var c=a.query.GET("ct");if(c!=""&&c!=null){e+="&ct="+c}}window.location=resources.search_url+"?all="+encodeURIComponent(f.stripTags())+e;return false},TrackNewsletter:function(){_gaq.push(["_trackPageview",resources.gacurl])},getParameterByName:function(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e="[\\?&]"+c+"=([^&#]*)";var d=new RegExp(e);var f=d.exec(window.location.href);if(f==null){return""}else{return decodeURIComponent(f[1].replace(/\+/g," "))}},OnReady:function(){String.prototype.stripTags=function(){return this.replace(/<(.|\n)*?>/g,"")};String.prototype.endsWith=function(d){return(this.match(d+"$")==d)};String.prototype.format=function(){var d=arguments;return this.replace(/{(\d+)}/g,function(e,f){return typeof d[f]!="undefined"?d[f]:e})};a("span.javascript-enabled input").val("1");try{if(location.search!=null&&location.search.indexOf("inCMS=True")!=-1&&window.location!=window.parent.location){location.href=a.query.load("?"+location.search).REMOVE("inCMS").toString()}}catch(c){}a("#SearchBox input[type=text],#QuickSearch input[type=text],input.jssearchbox").bind("focus",function(){if(a(this).val()==resources.header_search_searchboxvalue){a(this).val("")}}).bind("blur",function(){if(a(this).val()==""){a(this).val(resources.header_search_searchboxvalue)}}).bind("keydown",function(d){if(d.keyCode==13){return Main.DoSimpleSearch(a(this).val())}});a("#SearchBox input[type=submit]").bind("click",function(){return Main.DoSimpleSearch(a("input[type=text]",a(this).parent()).val())});a("body").bind("click",function(){b.HideAllOptions()});a("#header div.selectArea").bind("click",function(){if(a(this).hasClass("active-select")){b.HideAllOptions();a(this).removeClass("active-select");b.HideOptions(this.id)}else{b.HideAllOptions();a(this).addClass("active-select");b.ShowOptions(a(this),this.id)}return false});a("a.EnlargeImage","#wrapper").bind("click",function(){var h=encodeURIComponent(a(this).attr("href"));var d=a(this).parent().parent();var f=a(".events-content .date",d).html();var i=a(".events-content strong",d).html();var g=a(".events-content p",d).html();var e={contentUrl:resources.base_url+"Templates/Planet3/Pages/Popups/ThumbnailEnlarged.aspx .enlargepopup",contentParams:{imageUrl:h,uiculture:resources.uiculture}};Main.openLightbox(h,e,function(){var j=a(".lightbox:visible");a(".info h2",j).html(i);a(".info p.desc",j).html(g)});return false});a("a.BlogEnlargeImage","#wrapper").bind("click",function(){var f=encodeURIComponent(a(this).attr("href"));if(f.endsWith(".jpg")){var d=a(this).parent().parent();var e={contentUrl:resources.base_url+"Templates/Planet3/Pages/Popups/ThumbnailEnlarged.aspx .enlargepopup",contentParams:{imageUrl:f,uiculture:resources.uiculture}};Main.openLightbox(f,e,function(){var g=a(".lightbox:visible")})}else{window.open(a(this).attr("href"),"mywindow")}return false});if(a("div.tabset ul a").length&&a("#hidAjaxInput").length&&a("#hidAjaxInput").val()!=""){try{a(window).hashchange(function(){b.LoadAjaxTeaserListerTab(location.hash)});a(window).hashchange()}catch(c){}b.SetAjaxLinks()}if(a("#wrapper .donate-frm").length){a("div.donate-frm ul a","#wrapper").each(function(){a(this).click(function(){var d=a(this).closest("div.donate-frm");d.find("fieldset > div.tab").hide();d.find("input.donation-amount-input").val("");d.find(".donation-radio").attr("checked","");d.find(".donation-radio-other").attr("checked","");var e=a(this).attr("rel");d.find(e).show();d.find("li.active").removeClass("active");a(this).parent().addClass("active")})});a("input.donation-amount-input","#wrapper").each(function(){a(this).focus(function(){a(this).closest(".row").children(".donation-radio-other").attr("checked","checked")})});a("input.donation-radio","#wrapper").each(function(){a(this).click(function(){a(this).closest(".tab").find("input.donation-amount-input").val("")})})}a("div.form-button, div.form-button-ready","#wrapper").hover(function(){var d=a(this).attr("class");if(d!=null&&d.indexOf("form-button-ready")!=-1){a(this).removeClass("form-button-ready").addClass("form-button-ready-hover")}else{a(this).removeClass("form-button").addClass("form-button-hover")}},function(){var d=a(this).attr("class");if(d!=null&&d.indexOf("form-button-ready")!=-1){a(this).removeClass("form-button-ready-hover").addClass("form-button-ready")}else{a(this).removeClass("form-button-hover").addClass("form-button")}});a("div.search-button, div.search-button-ready","#wrapper").hover(function(){var d=a(this).attr("class");if(d!=null&&d.indexOf("search-button-ready")!=-1){a(this).attr("class",d.replace("search-button-ready","search-button-ready-hover"))}else{a(this).attr("class",d.replace("search-button","search-button-hover"))}},function(){var d=a(this).attr("class");if(d!=null&&d.indexOf("search-button-ready")!=-1){a(this).attr("class",d.replace("search-button-ready-hover","search-button-ready"))}else{a(this).attr("class",d.replace("search-button-hover","search-button"))}});Main.pinFooterToBottomPage();if(a("#sendfriend input[type=hidden]").length&&a("#sendfriend input[type=hidden]").val()=="1"){window.location.hash="#sendfriend"}if(typeof(Action)!="undefined"&&Action){Action.OnReady()}if(typeof(ActionShare)!="undefined"&&ActionShare){ActionShare.OnReady()}if(typeof(Donation)!="undefined"&&Donation){Donation.OnReady()}if(typeof(DonationCanada)!="undefined"&&DonationCanada){DonationCanada.OnReady()}if(typeof(DetailPage)!="undefined"&&DetailPage){DetailPage.OnReady()}if(typeof(Faq)!="undefined"&&Faq){Faq.OnReady()}if(typeof(MultimediaDetail)!="undefined"&&MultimediaDetail){MultimediaDetail.OnReady()}if(typeof(Blog)!="undefined"&&Blog){Blog.OnReady()}if(typeof(Account)!="undefined"&&Account){Account.OnReady()}if(typeof(SearchPage)!="undefined"&&SearchPage){SearchPage.OnReady()}if(typeof(Validator)!="undefined"&&Validator){Validator.OnReady()}if(typeof(ErrorPage)!="undefined"&&ErrorPage){ErrorPage.OnReady()}a(".light-box.onload","#wrapper").each(function(){new Lightbox({container:this}).Show()});setTimeout(function(){a("object","#wrapper").each(function(d){if(a("param[name=wmode]",this).length==0&&a("embed",this).length==1){a(this).prepend('<param value="transparent" name="wmode"/>');a("embed",this).attr("wmode","transparent")}})},0);a("#nav .drop-holder").bind("mouseenter",function(){a(this).prev().addClass("active-item")}).bind("mouseleave",function(){a(this).prev().removeClass("active-item")});a(".petition_box a.activate","div.onpage-widget").click(function(){a(".petition_box",a(this).closest(".widget-main")).removeClass("active");a(this).parent().parent().css("display","none");a(this).parent().parent().addClass("active");a(this).parent().parent().slideDown("slow");return false});a("div.action-widget-embed").find("a").click(function(){a("div",a(this).parent()).slideToggle("slow");if(a(this).hasClass("expanded")){a(this).removeClass("expanded")}else{a(this).addClass("expanded")}return false});if(a("div.action-widget").length){a("select[name=province]","div.action-widget").change(function(){var f=a(this).val();var e=a("select[name=district]",a(this).parents(".action-widget"));if(f==-1){a("option",e).show()}else{a("option:gt(0)",e).css("display","none");a("option[value$=;"+f+"]",e).show();a("option:visible:first",e).attr("selected",true)}})}Main.shareBarOnResize();a("#share_rail #share_pos.share_sidebar .paper").bind("resize",function(){Main.shareBarOnResize()});if((typeof(newsletterSignupSuccesful)!="undefined"&&newsletterSignupSuccesful==true)||(Main.getParameterByName("newsletterSignupSuccesful")=="true")){Main.TrackNewsletter()}},OnResize:function(){Main.pinFooterToBottomPage();Main.shareBarOnResize()}}}(jQuery);$(document).ready(function(a){Main.OnReady();try{var d=a.query.GET("showtimer");if(d!=""&&globalTimer!=null){var f=globalTimer.ShowIntermediate();var c="DOM Ready in "+f+" ms.";a("#loadTime").html(c)}}catch(b){}});$(window).load(function(){try{var c=$.query.GET("showtimer");if(c!=""&&globalTimer!=null){var d=globalTimer.Stop();var b=" Load in "+d+" ms.";$("#loadTime").append(b)}}catch(a){}});$(window).resize(function(){Main.OnResize()});function h2i(b){var a=b.charCodeAt(0);return(a>=65?a-7:a)-48}function dc(b,a){var c=$("img."+b);if(c.length){c.hide()}var f=new String();var d=(h2i(a.substr(0,1))*16)+h2i(a.substr(1,1))^d;var g=a.split("_");$.each(g.reverse(),function(e,h){if(h.length>=4){f+=String.fromCharCode(parseInt("0x"+h))}else{f+=String.fromCharCode((h2i(h.substr(0,1))*16)+h2i(h.substr(1))^d)}});return f}
/* @license-end */
